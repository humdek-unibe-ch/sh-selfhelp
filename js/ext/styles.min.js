"use strict";Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}}(),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;var u,o,i=0|e,a=Math.max(i>=0?i:r-Math.abs(i),0);for(;a<r;){if((u=n[a])===(o=t)||"number"==typeof u&&"number"==typeof o&&isNaN(u)&&isNaN(o))return!0;a++}return!1}});
"use strict";
/*!
	autosize 4.0.2
	license: MIT
	http://www.jacklmoore.com/autosize
*/!function(e,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),(e=e||self).autosize=n.exports}}(void 0,(function(e,t){var n,o,r="function"==typeof Map?new Map:(n=[],o=[],{has:function(e){return n.indexOf(e)>-1},get:function(e){return o[n.indexOf(e)]},set:function(e,t){-1===n.indexOf(e)&&(n.push(e),o.push(t))},delete:function(e){var t=n.indexOf(e);t>-1&&(n.splice(t,1),o.splice(t,1))}}),i=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){i=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function d(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!r.has(e)){var t,n=null,o=null,d=null,l=function(){e.clientWidth!==o&&f()},s=function(t){window.removeEventListener("resize",l,!1),e.removeEventListener("input",f,!1),e.removeEventListener("keyup",f,!1),e.removeEventListener("autosize:destroy",s,!1),e.removeEventListener("autosize:update",f,!1),Object.keys(t).forEach((function(n){e.style[n]=t[n]})),r.delete(e)}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",s,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",f,!1),window.addEventListener("resize",l,!1),e.addEventListener("input",f,!1),e.addEventListener("autosize:update",f,!1),e.style.overflowX="hidden",e.style.wordWrap="break-word",r.set(e,{destroy:s,update:f}),"vertical"===(t=window.getComputedStyle(e,null)).resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),n="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(n)&&(n=0),f()}function u(t){var n=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=n,e.style.overflowY=t}function a(){if(0!==e.scrollHeight){var t=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(e),r=document.documentElement&&document.documentElement.scrollTop;e.style.height="",e.style.height=e.scrollHeight+n+"px",o=e.clientWidth,t.forEach((function(e){e.node.scrollTop=e.scrollTop})),r&&(document.documentElement.scrollTop=r)}}function f(){a();var t=Math.round(parseFloat(e.style.height)),n=window.getComputedStyle(e,null),o="content-box"===n.boxSizing?Math.round(parseFloat(n.height)):e.offsetHeight;if(o<t?"hidden"===n.overflowY&&(u("scroll"),a(),o="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight):"hidden"!==n.overflowY&&(u("hidden"),a(),o="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight),d!==o){d=o;var r=i("autosize:resized");try{e.dispatchEvent(r)}catch(e){}}}}function l(e){var t=r.get(e);t&&t.destroy()}function s(e){var t=r.get(e);t&&t.update()}var u=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((u=function(e){return e}).destroy=function(e){return e},u.update=function(e){return e}):((u=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],(function(e){return d(e)})),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],l),e},u.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],s),e}),t.default=u,e.exports=t.default}));
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,r){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).deepmerge=r()}(void 0,(function(){var e=function(e){return function(e){return!!e&&"object"===_typeof(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===r}(e)}(e)};var r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function t(e,r){return!1!==r.clone&&r.isMergeableObject(e)?f((t=e,Array.isArray(t)?[]:{}),e,r):e;var t}function n(e,r,n){return e.concat(r).map((function(e){return t(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(r){return e.propertyIsEnumerable(r)})):[]}(e))}function u(e,r){try{return r in e}catch(e){return!1}}function c(e,r,n){var c={};return n.isMergeableObject(e)&&o(e).forEach((function(r){c[r]=t(e[r],n)})),o(r).forEach((function(o){(function(e,r){return u(e,r)&&!(Object.hasOwnProperty.call(e,r)&&Object.propertyIsEnumerable.call(e,r))})(e,o)||(u(e,o)&&n.isMergeableObject(r[o])?c[o]=function(e,r){if(!r.customMerge)return f;var t=r.customMerge(e);return"function"==typeof t?t:f}(o,n)(e[o],r[o],n):c[o]=t(r[o],n))})),c}function f(r,o,u){(u=u||{}).arrayMerge=u.arrayMerge||n,u.isMergeableObject=u.isMergeableObject||e,u.cloneUnlessOtherwiseSpecified=t;var f=Array.isArray(o);return f===Array.isArray(r)?f?u.arrayMerge(r,o,u):c(r,o,u):t(o,u)}return f.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,t){return f(e,t,r)}),{})},f}));
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define(t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t():e.ResizeSensor=t()}("undefined"!=typeof window?window:void 0,(function(){if("undefined"==typeof window)return null;var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};function t(e,t){var n=Object.prototype.toString.call(e),i="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,o=0,r=e.length;if(i)for(;o<r;o++)t(e[o]);else t(e)}function n(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}var i=function i(o,r){function s(){var e,t,n=[];this.add=function(e){n.push(e)},this.call=function(i){for(e=0,t=n.length;e<t;e++)n[e].call(this,i)},this.remove=function(i){var o=[];for(e=0,t=n.length;e<t;e++)n[e]!==i&&o.push(n[e]);n=o},this.length=function(){return n.length}}function d(t,i){if(t)if(t.resizedAttached)t.resizedAttached.add(i);else{t.resizedAttached=new s,t.resizedAttached.add(i),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var o="pointer-events: none; position: absolute; left: 0px; top: 0px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;",r="position: absolute; left: 0; top: 0; transition: 0s;";t.resizeSensor.style.cssText=o,t.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+o+'"><div style="'+r+'"></div></div><div class="resize-sensor-shrink" style="'+o+'"><div style="'+r+' width: 200%; height: 200%"></div></div>',t.appendChild(t.resizeSensor);var d=window.getComputedStyle(t),f=d?d.getPropertyValue("position"):null;"absolute"!==f&&"relative"!==f&&"fixed"!==f&&(t.style.position="relative");var c,l,u=t.resizeSensor.childNodes[0],h=u.childNodes[0],a=t.resizeSensor.childNodes[1],p=n(t),y=p.width,v=p.height,z=!0,m=0,w=function n(){if(z){if(0===t.offsetWidth&&0===t.offsetHeight)return void(m||(m=e((function(){m=0,n()}))));z=!1}var i,o;i=t.offsetWidth,o=t.offsetHeight,h.style.width=i+10+"px",h.style.height=o+10+"px",u.scrollLeft=i+10,u.scrollTop=o+10,a.scrollLeft=i+10,a.scrollTop=o+10};t.resizeSensor.resetSensor=w;var S=function(){l=0,c&&(y=p.width,v=p.height,t.resizedAttached&&t.resizedAttached.call(p))},g=function(){p=n(t),(c=p.width!==y||p.height!==v)&&!l&&(l=e(S)),w()},b=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)};b(u,"scroll",g),b(a,"scroll",g),e(w)}}t(o,(function(e){d(e,r)})),this.detach=function(e){i.detach(o,e)},this.reset=function(){o.resizeSensor.resetSensor()}};if(i.reset=function(e){t(e,(function(e){e.resizeSensor.resetSensor()}))},i.detach=function(e,n){t(e,(function(e){e&&(e.resizedAttached&&"function"==typeof n&&(e.resizedAttached.remove(n),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))}))},"undefined"!=typeof MutationObserver){var o=new MutationObserver((function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=e[t].addedNodes,o=0;o<n.length;o++)n[o].resizeSensor&&i.reset(n[o])}));document.addEventListener("DOMContentLoaded",(function(e){o.observe(document.body,{childList:!0,subtree:!0})}))}return i}));
"use strict";
/**
 * jQuery plugin for Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @license MIT
 */!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}((function(t){t.fn.sortable=function(e){var n,o=arguments;return this.each((function(){var i=t(this),a=i.data("sortable");a||!(e instanceof Object)&&e||(a=new Sortable(this,e),i.data("sortable",a)),a&&("widget"===e?n=a:"destroy"===e?(a.destroy(),i.removeData("sortable")):"function"==typeof a[e]?n=a[e].apply(a,[].slice.call(o,1)):e in a.options&&(n=a.option.apply(a,o)))})),void 0===n?this:n}}));
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*! Sortable 1.7.0 - MIT | git://github.com/rubaxa/Sortable.git */!function(t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():window.Sortable=t()}((function(){if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var t,e,n,o,i,r,a,l,s,c,d,u,h,f,p,g,v,m,b,_,y,D={},w=/\s+/g,S=/left|right|inline/,T="Sortable"+(new Date).getTime(),C=window,E=C.document,x=C.parseInt,k=C.setTimeout,N=C.jQuery||C.Zepto,B=C.Polymer,P=!1,Y="draggable"in E.createElement("div"),X=!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&((y=E.createElement("x")).style.cssText="pointer-events:auto","auto"===y.style.pointerEvents),O=!1,I=Math.abs,M=Math.min,A=[],R=[],L=function(){return!1},F=ot((function(t,e,n){if(n&&e.scroll){var o,i,r,a,d,u,h=n[T],f=e.scrollSensitivity,p=e.scrollSpeed,g=t.clientX,v=t.clientY,m=window.innerWidth,_=window.innerHeight;if(s!==n&&(l=e.scroll,s=n,c=e.scrollFn,!0===l)){l=n;do{if(l.offsetWidth<l.scrollWidth||l.offsetHeight<l.scrollHeight)break}while(l=l.parentNode)}l&&(o=l,i=l.getBoundingClientRect(),r=(I(i.right-g)<=f)-(I(i.left-g)<=f),a=(I(i.bottom-v)<=f)-(I(i.top-v)<=f)),r||a||(a=(_-v<=f)-(v<=f),((r=(m-g<=f)-(g<=f))||a)&&(o=C)),D.vx===r&&D.vy===a&&D.el===o||(D.el=o,D.vx=r,D.vy=a,clearInterval(D.pid),o&&(D.pid=setInterval((function(){u=a?a*p:0,d=r?r*p:0,"function"==typeof c&&"continue"!==c.call(h,d,u,t,b,o)||(o===C?C.scrollTo(C.pageXOffset+d,C.pageYOffset+u):(o.scrollTop+=u,o.scrollLeft+=d))}),24)))}}),30),H=function(t){function e(t,e){return null!=t&&!0!==t||null!=(t=n.name)?"function"==typeof t?t:function(n,o){var i=o.options.group.name;return e?t:t&&(t.join?t.indexOf(i)>-1:i==t)}:L}var n={},o=t.group;o&&"object"==_typeof(o)||(o={name:o}),n.name=o.name,n.checkPull=e(o.pull,!0),n.checkPut=e(o.put),n.revertClone=o.revertClone,t.group=n};try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){P={capture:!1,passive:!1}}}))}catch(t){}function W(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=it({},e),t[T]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==W.supportPointer};for(var o in n)!(o in e)&&(e[o]=n[o]);for(var i in H(e),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!e.forceFallback&&Y,V(t,"mousedown",this._onTapStart),V(t,"touchstart",this._onTapStart),e.supportPointer&&V(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(V(t,"dragover",this),V(t,"dragenter",this)),R.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function j(e,n){"clone"!==e.lastPullMode&&(n=!0),o&&o.state!==n&&(G(o,"display",n?"none":""),n||o.state&&(e.options.group.revertClone?(i.insertBefore(o,r),e._animate(t,o)):i.insertBefore(o,t)),o.state=n)}function U(t,e,n){if(t){n=n||E;do{if(">*"===e&&t.parentNode===n||nt(t,e))return t}while(t=(i=(o=t).host)&&i.nodeType?i:o.parentNode)}var o,i;return null}function V(t,e,n){t.addEventListener(e,n,P)}function q(t,e,n){t.removeEventListener(e,n,P)}function z(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(w," ").replace(" "+e+" "," ");t.className=(o+(n?" "+e:"")).replace(w," ")}}function G(t,e,n){var o=t&&t.style;if(o){if(void 0===n)return E.defaultView&&E.defaultView.getComputedStyle?n=E.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in o||(e="-webkit-"+e),o[e]=n+("string"==typeof n?"":"px")}}function Q(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function Z(t,e,n,i,r,a,l,s,c){t=t||e[T];var d=E.createEvent("Event"),u=t.options,h="on"+n.charAt(0).toUpperCase()+n.substr(1);d.initEvent(n,!0,!0),d.to=r||e,d.from=a||e,d.item=i||e,d.clone=o,d.oldIndex=l,d.newIndex=s,d.originalEvent=c,e.dispatchEvent(d),u[h]&&u[h].call(t,d)}function J(t,e,n,o,i,r,a,l){var s,c,d=t[T],u=d.options.onMove;return(s=E.createEvent("Event")).initEvent("move",!0,!0),s.to=e,s.from=t,s.dragged=n,s.draggedRect=o,s.related=i||e,s.relatedRect=r||e.getBoundingClientRect(),s.willInsertAfter=l,s.originalEvent=a,t.dispatchEvent(s),u&&(c=u.call(d,s,a)),c}function K(t){t.draggable=!1}function $(){O=!1}function tt(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}function et(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!nt(t,e)||n++;return n}function nt(t,e){if(t){if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e)}return!1}function ot(t,e){var n,o;return function(){void 0===n&&(n=arguments,o=this,k((function(){1===n.length?t.call(o,n[0]):t.apply(o,n),n=void 0}),e))}}function it(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function rt(t){return B&&B.dom?B.dom(t).cloneNode(!0):N?N(t).clone(!0)[0]:t.cloneNode(!0)}function at(t){return k(t,0)}function lt(t){return clearTimeout(t)}return W.prototype={constructor:W,_onTapStart:function(e){var n,o=this,i=this.el,r=this.options,l=r.preventOnFilter,s=e.type,c=e.touches&&e.touches[0],d=(c||e).target,u=e.target.shadowRoot&&e.path&&e.path[0]||d,h=r.filter;if(function(t){A.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&A.push(o)}}(i),!t&&!(/mousedown|pointerdown/.test(s)&&0!==e.button||r.disabled)&&!u.isContentEditable&&(d=U(d,r.draggable,i))&&a!==d){if(n=et(d,r.draggable),"function"==typeof h){if(h.call(this,e,d,this))return Z(o,u,"filter",d,i,i,n),void(l&&e.preventDefault())}else if(h&&(h=h.split(",").some((function(t){if(t=U(u,t.trim(),i))return Z(o,t,"filter",d,i,i,n),!0}))))return void(l&&e.preventDefault());r.handle&&!U(u,r.handle,i)||this._prepareDragStart(e,c,d,n)}},_prepareDragStart:function(n,o,l,s){var c,d=this,u=d.el,h=d.options,p=u.ownerDocument;l&&!t&&l.parentNode===u&&(m=n,i=u,e=(t=l).parentNode,r=t.nextSibling,a=l,g=h.group,f=s,this._lastX=(o||n).clientX,this._lastY=(o||n).clientY,t.style["will-change"]="all",c=function(){d._disableDelayedDrag(),t.draggable=d.nativeDraggable,z(t,h.chosenClass,!0),d._triggerDragStart(n,o),Z(d,i,"choose",t,i,i,f)},h.ignore.split(",").forEach((function(e){Q(t,e.trim(),K)})),V(p,"mouseup",d._onDrop),V(p,"touchend",d._onDrop),V(p,"touchcancel",d._onDrop),V(p,"selectstart",d),h.supportPointer&&V(p,"pointercancel",d._onDrop),h.delay?(V(p,"mouseup",d._disableDelayedDrag),V(p,"touchend",d._disableDelayedDrag),V(p,"touchcancel",d._disableDelayedDrag),V(p,"mousemove",d._disableDelayedDrag),V(p,"touchmove",d._disableDelayedDrag),h.supportPointer&&V(p,"pointermove",d._disableDelayedDrag),d._dragStartTimer=k(c,h.delay)):c())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),q(t,"mouseup",this._disableDelayedDrag),q(t,"touchend",this._disableDelayedDrag),q(t,"touchcancel",this._disableDelayedDrag),q(t,"mousemove",this._disableDelayedDrag),q(t,"touchmove",this._disableDelayedDrag),q(t,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(e,n){(n=n||("touch"==e.pointerType?e:null))?(m={target:t,clientX:n.clientX,clientY:n.clientY},this._onDragStart(m,"touch")):this.nativeDraggable?(V(t,"dragend",this),V(i,"dragstart",this._onDragStart)):this._onDragStart(m,!0);try{E.selection?at((function(){E.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){if(i&&t){var e=this.options;z(t,e.ghostClass,!0),z(t,e.dragClass,!1),W.active=this,Z(this,i,"start",t,i,i,f)}else this._nulling()},_emulateDragOver:function(){if(b){if(this._lastX===b.clientX&&this._lastY===b.clientY)return;this._lastX=b.clientX,this._lastY=b.clientY,X||G(n,"display","none");var t=E.elementFromPoint(b.clientX,b.clientY),e=t,o=R.length;if(t&&t.shadowRoot&&(e=t=t.shadowRoot.elementFromPoint(b.clientX,b.clientY)),e)do{if(e[T]){for(;o--;)R[o]({clientX:b.clientX,clientY:b.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);X||G(n,"display","")}},_onTouchMove:function(t){if(m){var e=this.options,o=e.fallbackTolerance,i=e.fallbackOffset,r=t.touches?t.touches[0]:t,a=r.clientX-m.clientX+i.x,l=r.clientY-m.clientY+i.y,s=t.touches?"translate3d("+a+"px,"+l+"px,0)":"translate("+a+"px,"+l+"px)";if(!W.active){if(o&&M(I(r.clientX-this._lastX),I(r.clientY-this._lastY))<o)return;this._dragStarted()}this._appendGhost(),_=!0,b=r,G(n,"webkitTransform",s),G(n,"mozTransform",s),G(n,"msTransform",s),G(n,"transform",s),t.preventDefault()}},_appendGhost:function(){if(!n){var e,o=t.getBoundingClientRect(),r=G(t),a=this.options;z(n=t.cloneNode(!0),a.ghostClass,!1),z(n,a.fallbackClass,!0),z(n,a.dragClass,!0),G(n,"top",o.top-x(r.marginTop,10)),G(n,"left",o.left-x(r.marginLeft,10)),G(n,"width",o.width),G(n,"height",o.height),G(n,"opacity","0.8"),G(n,"position","fixed"),G(n,"zIndex","100000"),G(n,"pointerEvents","none"),a.fallbackOnBody&&E.body.appendChild(n)||i.appendChild(n),e=n.getBoundingClientRect(),G(n,"width",2*o.width-e.width),G(n,"height",2*o.height-e.height)}},_onDragStart:function(e,n){var r=this,a=e.dataTransfer,l=r.options;r._offUpEvents(),g.checkPull(r,r,t,e)&&((o=rt(t)).draggable=!1,o.style["will-change"]="",G(o,"display","none"),z(o,r.options.chosenClass,!1),r._cloneId=at((function(){i.insertBefore(o,t),Z(r,i,"clone",t)}))),z(t,l.dragClass,!0),n?("touch"===n?(V(E,"touchmove",r._onTouchMove),V(E,"touchend",r._onDrop),V(E,"touchcancel",r._onDrop),l.supportPointer&&(V(E,"pointermove",r._onTouchMove),V(E,"pointerup",r._onDrop))):(V(E,"mousemove",r._onTouchMove),V(E,"mouseup",r._onDrop)),r._loopId=setInterval(r._emulateDragOver,50)):(a&&(a.effectAllowed="move",l.setData&&l.setData.call(r,a,t)),V(E,"drop",r),r._dragStartId=at(r._dragStarted))},_onDragOver:function(a){var l,s,c,f,p,m,b=this.el,y=this.options,D=y.group,w=W.active,C=g===D,E=!1,x=y.sort;if(void 0!==a.preventDefault&&(a.preventDefault(),!y.dragoverBubble&&a.stopPropagation()),!t.animated&&(_=!0,w&&!y.disabled&&(C?x||(f=!i.contains(t)):v===this||(w.lastPullMode=g.checkPull(this,w,t,a))&&D.checkPut(this,w,t,a))&&(void 0===a.rootEl||a.rootEl===this.el))){if(F(a,y,this.el),O)return;if(l=U(a.target,y.draggable,b),s=t.getBoundingClientRect(),v!==this&&(v=this,E=!0),f)return j(w,!0),e=i,void(o||r?i.insertBefore(t,o||r):x||i.appendChild(t));if(0===b.children.length||b.children[0]===n||b===a.target&&(p=a,m=b.lastElementChild.getBoundingClientRect(),p.clientY-(m.top+m.height)>5||p.clientX-(m.left+m.width)>5)){if(0!==b.children.length&&b.children[0]!==n&&b===a.target&&(l=b.lastElementChild),l){if(l.animated)return;c=l.getBoundingClientRect()}j(w,C),!1!==J(i,b,t,s,l,c,a)&&(t.contains(b)||(b.appendChild(t),e=b),this._animate(s,t),l&&this._animate(c,l))}else if(l&&!l.animated&&l!==t&&void 0!==l.parentNode[T]){d!==l&&(d=l,u=G(l),h=G(l.parentNode));var N=(c=l.getBoundingClientRect()).right-c.left,B=c.bottom-c.top,P=S.test(u.cssFloat+u.display)||"flex"==h.display&&0===h["flex-direction"].indexOf("row"),Y=l.offsetWidth>t.offsetWidth,X=l.offsetHeight>t.offsetHeight,I=(P?(a.clientX-c.left)/N:(a.clientY-c.top)/B)>.5,M=l.nextElementSibling,A=!1;if(P){var R=t.offsetTop,L=l.offsetTop;A=R===L?l.previousElementSibling===t&&!Y||I&&Y:l.previousElementSibling===t||t.previousElementSibling===l?(a.clientY-c.top)/B>.5:L>R}else E||(A=M!==t&&!X||I&&X);var H=J(i,b,t,s,l,c,a,A);!1!==H&&(1!==H&&-1!==H||(A=1===H),O=!0,k($,30),j(w,C),t.contains(b)||(A&&!M?b.appendChild(t):l.parentNode.insertBefore(t,A?M:l)),e=t.parentNode,this._animate(s,t),this._animate(c,l))}}},_animate:function(t,e){var n=this.options.animation;if(n){var o=e.getBoundingClientRect();1===t.nodeType&&(t=t.getBoundingClientRect()),G(e,"transition","none"),G(e,"transform","translate3d("+(t.left-o.left)+"px,"+(t.top-o.top)+"px,0)"),e.offsetWidth,G(e,"transition","all "+n+"ms"),G(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=k((function(){G(e,"transition",""),G(e,"transform",""),e.animated=!1}),n)}},_offUpEvents:function(){var t=this.el.ownerDocument;q(E,"touchmove",this._onTouchMove),q(E,"pointermove",this._onTouchMove),q(t,"mouseup",this._onDrop),q(t,"touchend",this._onDrop),q(t,"pointerup",this._onDrop),q(t,"touchcancel",this._onDrop),q(t,"pointercancel",this._onDrop),q(t,"selectstart",this)},_onDrop:function(a){var l=this.el,s=this.options;clearInterval(this._loopId),clearInterval(D.pid),clearTimeout(this._dragStartTimer),lt(this._cloneId),lt(this._dragStartId),q(E,"mouseover",this),q(E,"mousemove",this._onTouchMove),this.nativeDraggable&&(q(E,"drop",this),q(l,"dragstart",this._onDragStart)),this._offUpEvents(),a&&(_&&(a.preventDefault(),!s.dropBubble&&a.stopPropagation()),n&&n.parentNode&&n.parentNode.removeChild(n),i!==e&&"clone"===W.active.lastPullMode||o&&o.parentNode&&o.parentNode.removeChild(o),t&&(this.nativeDraggable&&q(t,"dragend",this),K(t),t.style["will-change"]="",z(t,this.options.ghostClass,!1),z(t,this.options.chosenClass,!1),Z(this,i,"unchoose",t,e,i,f,null,a),i!==e?(p=et(t,s.draggable))>=0&&(Z(null,e,"add",t,e,i,f,p,a),Z(this,i,"remove",t,e,i,f,p,a),Z(null,e,"sort",t,e,i,f,p,a),Z(this,i,"sort",t,e,i,f,p,a)):t.nextSibling!==r&&(p=et(t,s.draggable))>=0&&(Z(this,i,"update",t,e,i,f,p,a),Z(this,i,"sort",t,e,i,f,p,a)),W.active&&(null!=p&&-1!==p||(p=f),Z(this,i,"end",t,e,i,f,p,a),this.save()))),this._nulling()},_nulling:function(){i=t=e=n=r=o=a=l=s=m=b=_=p=d=u=v=g=W.active=null,A.forEach((function(t){t.checked=!0})),A.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragover":case"dragenter":t&&(this._onDragOver(e),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}(e));break;case"mouseover":this._onDrop(e);break;case"selectstart":e.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,o=0,i=n.length,r=this.options;o<i;o++)U(t=n[o],r.draggable,this.el)&&e.push(t.getAttribute(r.dataIdAttr)||tt(t));return e},sort:function(t){var e={},n=this.el;this.toArray().forEach((function(t,o){var i=n.children[o];U(i,this.options.draggable,n)&&(e[t]=i)}),this),t.forEach((function(t){e[t]&&(n.removeChild(e[t]),n.appendChild(e[t]))}))},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return U(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];n[t]=e,"group"===t&&H(n)},destroy:function(){var t=this.el;t[T]=null,q(t,"mousedown",this._onTapStart),q(t,"touchstart",this._onTapStart),q(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(q(t,"dragover",this),q(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),R.splice(R.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},V(E,"touchmove",(function(t){W.active&&t.preventDefault()})),W.utils={on:V,off:q,css:G,find:Q,is:function(t,e){return!!U(t,e,t)},extend:it,throttle:ot,closest:U,toggleClass:z,clone:rt,index:et,nextTick:at,cancelNextTick:lt},W.create=function(t,e){return new W(t,e)},W.version="1.7.0",W}));
"use strict";$(document).ready((function(){$(".accordion-header a").click((function(c){c.stopPropagation()}))}));
"use strict";$(document).ready((function(){var t="autocomplete";$("div.input-autocomplete").each((function(){var e=$(this).children("div.input-autocomplete-search-target"),i=$(this).children("div.input-autocomplete-debug"),a=$(this).children("div.input-autocomplete-callback"),n=$(this).find("input.input-autocomplete-value"),o=$(this).find("input.input-autocomplete-search");function c(i,a){n.val(i.substr(t.length+1)),o.val(a),e.empty()}o.on("keydown",(function(i){if("Escape"===i.key)o.val(""),e.empty(),n.val("");else if("ArrowDown"===i.key||"ArrowUp"===i.key){i.preventDefault();var a,l=$('.list-group-item-action.active[id|="'.concat(t,'"]'));(a="ArrowDown"===i.key?l.next():l.prev()).hasClass("list-group-item-action")&&(l.removeClass("active"),a.addClass("active"))}else if("Enter"===i.key){i.preventDefault(),0!==(l=$('.list-group-item-action.active[id|="'.concat(t,'"]'))).length&&c(l.attr("id"),l.text())}})),o.on("keyup",(function(o){var l=$(this).val();l.length<1||"ArrowDown"!==o.key&&"ArrowUp"!==o.key&&"Enter"!==o.key&&"Escape"!==o.key&&$.post(BASE_PATH+"/request/"+a.text(),{search:l},(function(a){var o=$("<div/>",{class:"list-group"});a.success?(a.data.forEach((function(e,i){var a="";0===i&&(a=" active",n.val(e.id)),o.append($("<div/>",{class:"list-group-item list-group-item-action"+a,id:t+"-"+e.id}).append(e.value).on("click",(function(){c($(this).attr("id"),$(this).text())})))})),e.html(o)):(console.log(a),i.html(a.data))}),"json")}))}))}));
"use strict";function updateDepth(t,e){var n=t.turn("page"),i=t.turn("pages"),r=16*Math.min(1,2*n/i);(e=e||n)>3?$(".book-turnjs .p2 .depth").css({width:r,left:20-r}):$(".book-turnjs .p2 .depth").css({width:0}),r=16*Math.min(1,2*(i-n)/i),e<i-3?$(".book-turnjs .secondLast .depth").css({width:r,right:20-r}):$(".book-turnjs .secondLast .depth").css({width:0})}function getViewNumber(t,e){return parseInt((e||t.turn("page"))/2+1,10)}function setButtonsVisibility(t,e){1==t?$("#book-previous-button").addClass("invisible"):$("#book-previous-button").removeClass("invisible"),t==e?$("#book-next-button").addClass("invisible"):$("#book-next-button").removeClass("invisible")}function setSlider(){$("#slider").slider({min:1,max:100,stop:function(){$(".book-turnjs").turn("page",Math.max(1,2*$(this).slider("value")-2))}})}$(document).ready((function(){$(".book-turnjs").each((function(){var t=!1,e=$(this).data("config");e&&'""'!=e||(e={});var n=!1;e&&e.slider?(n=!0,setSlider()):$("#slider-bar").addClass("d-none"),e.when={turning:function(n,i,r){var s=this;if($(this).turn("data").hover)return $(this).turn("data").hover=!1,void n.preventDefault();var a=$(this),u=a.turn("page"),o=a.turn("pages");if(e.saveOnTurnPage)for(var d=0;d<i;d++)for(var p=0;p<$(this).find('[page="'+d+'"]').find("input,textarea,select").filter("[required]").length;p++){var l=$(this).find('[page="'+d+'"]').find("input,textarea,select").filter("[required]")[p];if("radio"==$(l).attr("type")&&!$(this).find('[page="'+d+'"]').find('input[name="'+$(l).attr("name")+'"]:checked').val())return n.preventDefault(),a.turn("page",d),void l.reportValidity();if(!$(l).val())return n.preventDefault(),a.turn("page",d),void l.reportValidity()}if(window.location.hash="#page-"+i,u>3&&u<o-3){if(1==i)return a.turn("page",2).turn("stop").turn("page",i),void n.preventDefault();if(i==o)return a.turn("page",o-1).turn("stop").turn("page",i),void n.preventDefault()}else if(i>3&&i<o-3){if(1==u)return a.turn("page",2).turn("stop").turn("page",i),void n.preventDefault();if(u==o)return a.turn("page",o-1).turn("stop").turn("page",i),void n.preventDefault()}(updateDepth(a,i),i>=2?$(".book-turnjs .p2").addClass("fixed"):$(".book-turnjs .p2").removeClass("fixed"),i<a.turn("pages")?$(".book-turnjs .secondLast").addClass("fixed"):$(".book-turnjs .secondLast").removeClass("fixed"),e.saveOnTurnPage)&&(a.turn("view").forEach((function(t){$(s).find('[page="'+t+'"]').find(":submit").click()})),t&&$(this).parent().find("> :submit").click());setButtonsVisibility(i,o)},turned:function(t,e,i){var r=$(this);2!=e&&3!=e||r.turn("peel","br"),updateDepth(r),n&&$("#slider").slider("value",getViewNumber(r,e)),r.turn("center")},end:function(t,e){var i=$(this);updateDepth(i),setTimeout((function(){n&&$("#slider").slider("value",getViewNumber(i))}),1)},missing:function(t,e){},start:function(t,n,i){if(e.stopClickPageTurn&&null!=i)return $(this).turn("data").hover=!0,t.preventDefault()}},$(this).turn(e),setButtonsVisibility(r||1,$(this).turn("pages"));var i=$(this),r=window.location.hash.substring(1);r?$(this).turn("page",r.replace("page-","")):t=!0,n&&$("#slider").slider("option","max",$(this).turn("pages")/2+1),$(this).addClass("animated"),$("#canvas").css({visibility:""}),e.showButtons&&($("#book-buttons").removeClass("d-none"),$("#book-buttons").addClass("d-flex"),$("#book-previous-button").click((function(t){i.turn("data").hover=!1,t.preventDefault(),i.turn("previous")})),$("#book-next-button").click((function(t){i.turn("data").hover=!1,t.preventDefault(),i.turn("next")}))),setTimeout((function(){t=!0}),2e3)}))})),$("#canvas").css({visibility:"hidden"});
"use strict";function toggle_collapsible_card(a){var l=a,s=a.find("i.card-icon-collapse"),o=a.next();o.hasClass("show")?o.hide("fast",(function(){o.removeClass("show"),l.addClass("collapsed"),s.removeClass("fa-angle-double-up"),s.addClass("fa-angle-double-down")})):o.show("fast",(function(){o.addClass("show"),l.removeClass("collapsed"),s.removeClass("fa-angle-double-down"),s.addClass("fa-angle-double-up")}))}$(document).ready((function(){toggle_collapsible_card($(".style-"+window.location.hash.substring(1)+".card:not(.no-anchor-expand) > .card-header.collapsible.collapsed")),$("div.card-header.collapsible").on("click",(function(){toggle_collapsible_card($(this))}))}));
"use strict";$(document).ready((function(){$("#subjects").DataTable({dom:"ftipr",bInfo:!1,bAutoWidth:!1,aaSorting:[]});var o=$(".chatOverflow"),t=document.body.scrollHeight,e=o.height(),i=e-(t-$(window).height());i>0&&o.height(i),o.scrollTop(t),$(window).resize((function(){var i=e-(t-$(window).height());i>0&&o.height(i),o.scrollTop(t)})),$("#subjects").removeClass("d-none")}));
"use strict";function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function asyncGeneratorStep(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){asyncGeneratorStep(o,n,a,i,s,"next",e)}function s(e){asyncGeneratorStep(o,n,a,i,s,"throw",e)}i(void 0)}))}}function exportPageToPDF(){return _exportPageToPDF.apply(this,arguments)}function _exportPageToPDF(){return(_exportPageToPDF=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,s,c,f,l,p,d,u,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=$("#pdfExportHolder").parent(),r=document.createElement("div"),$(r).addClass("pdfA4"),n=$(t).children(),a=_createForOfIteratorHelper(n),e.prev=5,a.s();case 7:if((o=a.n()).done){e.next=46;break}if(i=o.value,0===$(i).find("#pdfExportHolder").length&&!$(i).is("#pdfExportHolder")){e.next=12;break}e.next=44;break;case 12:if(0===$(i).find(".graph-base").length&&!$(i).hasClass("graph-base")){e.next=41;break}s=$(i).find(".graph-plot"),c=_createForOfIteratorHelper(s),e.prev=15,c.s();case 17:if((f=c.n()).done){e.next=31;break}return l=f.value,p=l.cloneNode(!0),$(p).addClass("graphToImg"),$(t).append(p),e.next=24,Plotly.toImage(l,{format:"png",width:$(p).width(),height:$(p).height()}).then((function(e){return $(p).remove(),e}));case 24:d=e.sent,(u=$("<img>")).attr("src",d),$(u).addClass("pdfA4ImgGraph"),$(r).append(u);case 29:e.next=17;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(15),c.e(e.t0);case 36:return e.prev=36,c.f(),e.finish(36);case 39:e.next=44;break;case 41:$(i).find("img").each((function(){$(this).addClass("pdfA4Img")})),h=i.cloneNode(!0),$(r).append(h);case 44:e.next=7;break;case 46:e.next=51;break;case 48:e.prev=48,e.t1=e.catch(5),a.e(e.t1);case 51:return e.prev=51,a.f(),e.finish(51);case 54:$(r).find("[class*=col-3]").each((function(){$(this).addClass("pdfA4Col-3")})),$(r).find("[class*=col-sm-6]").each((function(){$(this).addClass("pdfA4Col-sm-6")})),$(r).find("[class*=col-sm-4]").each((function(){$(this).addClass("pdfA4Col-sm-4")})),$(r).find("[class*=col-sm]").each((function(){$(this).addClass("pdfA4Col-sm")})),htmlToPDF(r);case 59:case"end":return e.stop()}}),e,null,[[5,48,51,54],[15,33,36,39]])})))).apply(this,arguments)}function htmlToPDF(e){$(e).find(".skipPDF").each((function(){$(this).remove()}));html2pdf().set({margin:20,filename:"Download.pdf",pagebreak:{before:".pdfStartNewPage",after:[".pdfStartNewPageAfter"],avoid:"img"},image:{type:"jpeg",quality:.98},html2canvas:{scale:4,DPI:600},jsPDF:{unit:"pt",format:"letter",orientation:"portrait"}}).from(e).save()}$(document).ready((function(){$("#pdfExport").click((function(){exportPageToPDF()}))}));
"use strict";$(document).ready((function(){$(".entryList").each((function(){var e=$(this).attr("class").split(" "),t={columnDefs:[]};t.columnDefs.push({orderable:e.includes("dt-sortable"),targets:"_all"}),t.searching=e.includes("dt-searching"),t.bPaginate=e.includes("dt-bPaginate"),t.bInfo=e.includes("dt-bInfo");for(var r=e.filter((function(e){return e.includes("dt-order")})),n=0;n<r.length;n++){var s=r[n].split("-");4==s.length&&(s[2]!=parseInt(s[2],10)||"asc"!==s[3]&&"desc"!==s[3]||(t.order||(t.order=[]),t.order.push([s[2],s[3]])))}r=e.filter((function(e){return e.includes("dt-hide")}));for(var a=0;a<r.length;a++){var i=r[a].split("-");3==i.length&&i[2]==parseInt(i[2],10)&&t.columnDefs.push({targets:[parseInt(i[2],10)],visible:!1})}$(this).DataTable(t)}))}));
"use strict";function filterInit(a,e){$("div.filter-"+a).each((function(a){var t=$(this),n=parseFilterData(t.children("div.filter-data")),s=new CustomEvent("data-filter-"+n.data_source,{});e(t,n,s)}))}function filterEventHandler(a,e,t,n,s){a.removeClass("d-none"),$.post(BASE_PATH+"/request/AjaxDataSource/set_data_filter",{action:e.hasClass("active")?"rm":"add",name:n.name,value:n.value[t],value_idx:t,data_source:n.data_source},(function(t){t.success?(console.log("dispatch event: "+s.type),window.dispatchEvent(s),a.addClass("d-none"),e.toggleClass("active")):console.log(t)}),"json")}function parseFilterData(a){var e=a.text();try{return JSON.parse(e)}catch(a){return console.log("cannot parse raw data of graph"),console.log(a),null}}
"use strict";function filterToggleActionHandler(t,e,i){t.find("button.filter-toggle-switch").each((function(t){var n=$(this),l=n.children("i.filter-toggle-pending");n.click((function(){filterEventHandler(l,n,t,e,i)}))}))}$(document).ready((function(){filterInit("toggle",filterToggleActionHandler)}));
"use strict";$(document).ready((function(){filterInit("toggle-group",filterToggleActionHandler)}));
"use strict";function formSubmitEvent(){$("form").on("submit",(function(t){if(1==$(this).find('input[name="ajax"]').val()){var e=1==$(this).find('input[name="is_log"]').val(),i=$(this).find('input[name="redirect_at_end"]').val();t.preventDefault(),$(".alert-danger").remove(),$(".alert-success").remove();var r=[];$(this).find(":submit").each((function(){var t=$(this).html();r.push({btn:this,origLabel:t}),$(this).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"> </span> '+t)}));var n=this;$.ajax({type:"post",url:$(this).attr("action"),data:$(this).serialize(),success:function(t){var a=(new DOMParser).parseFromString(t,"text/html");check_input_locked_after_submit(),check_radio_locked_after_submit(),check_select_locked_after_submit(),check_slider_locked_after_submit(),check_textarea_locked_after_submit(),$(a).find(".alert-success").each((function(){$(this).insertBefore($(n)[0])})),$(a).find(".alert-danger").each((function(){$(this).insertBefore($(n)[0])})),e&&$(n)[0].reset(),r.forEach((function(t){$(t.btn).html(t.origLabel)})),i&&(window.location=i)}})}}))}$(document).ready((function(){formSubmitEvent()}));
"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,t){if(r){if("string"==typeof r)return _arrayLikeToArray(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _objectWithoutProperties(r,t){if(null==r)return{};var e,n,a=_objectWithoutPropertiesLoose(r,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(r,e)&&(a[e]=r[e])}return a}function _objectWithoutPropertiesLoose(r,t){if(null==r)return{};var e,n,a={},o=Object.keys(r);for(n=0;n<o.length;n++)e=o[n],t.indexOf(e)>=0||(a[e]=r[e]);return a}function drawGraph(r,t,e,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=r.prev(),c=0,u=[],l=0,f=[];return Plotly.newPlot(r[0],[],e,n),t.forEach((function(s,p){if("data_source"in s){var h=s.data_source,y=_objectWithoutProperties(s,["data_source"]),d="data-filter-".concat(h.name);i.removeClass("d-none"),c++,o&&!f.includes(d)&&(f.push(d),window.addEventListener(d,(function(o){console.log("received event: "+d),drawGraph(r,t,e,n,a)}))),$.post(BASE_PATH+"/request/AjaxDataSource/get_data_table",{name:h.name,single_user:!!h.single_user&&h.single_user},(function(t){if(t.success){var e={};e="cb"in h?h.cb(t.data):graphTraceCb(t.data,h,p),u[p]=deepmerge(y,e),Plotly.addTraces(r[0],u[p]),l>p&&Plotly.moveTraces(r[0],l,p),l++,a(),0===--c&&i.addClass("d-none")}else console.log(t)}),"json")}else u[p]=s,l++,Plotly.addTraces(r[0],s,p)})),{count:l,traces:u}}function graphTraceCb(r,t){var e={},n=function(n){graphExpandDotString(e,n,[]);var a=t.map[n],o=graphExpandDotString(e,n,[]);Array.isArray(a)?a.forEach((function(t){var e=0;"max"===t.op?e=Math.max.apply(Math,r.map((function(r){return r[t.name]}))):"min"===t.op?e=Math.min.apply(Math,r.map((function(r){return r[t.name]}))):"sum"===t.op?e=r.reduce((function(r,e){return r+Number(e[t.name])}),0):"avg"===t.op&&(e=r.reduce((function(r,e){return r+Number(e[t.name])}),0),e/=r.length),o.push(e)})):"object"===_typeof(a)&&null!==a?graphTraceCbData(r,e,o,a.name,a.ignore,a.options,a.order,a.maps,a.children):r.forEach((function(r){o.push(r[a])}))};for(var a in t.map)n(a);return e}function graphTraceCbData(r,t,e,n,a,o,i){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{},l={},f={};for(var s in c)f[s]=graphExpandDotString(t,s,[]);var p=!1,h=0,y=!1,d=null;if("object"===_typeof(i)&&null!==i&&"vals"in i&&(y=!0),r.forEach((function(r){var t=r[n];if(!a||!a.includes(t)){if(!(t in l))for(var u in p=!0,l[t]=y?i.vals.indexOf(Number(t)):e.length,e[l[t]]=0,c)f[u][l[t]]=c[u][t];"count"===o.op||"percent"===o.op?e[l[t]]++:"sum"===o.op?e[l[t]]+=t:"val"===o.op?e[l[t]]=Number(t):"idx"===o.op&&p&&(e[l[t]]=h++,p=!1)}})),"percent"===o.op)for(var g=0;g<e.length;g++)e[g]/=r.length;if("range"in o&&"min"in o.range&&"max"in o.range)for(var m=Math.max.apply(Math,_toConsumableArray(e)),v=Math.min.apply(Math,_toConsumableArray(e)),b=0;b<e.length;b++)e[b]=(e[b]-v)*(o.range.max-o.range.min)/(m-v)+o.range.min;if("factor"in o)for(var _=0;_<e.length;_++)e[_]*=o.factor;if("offset"in o)for(var A=0;A<e.length;A++)e[A]+=o.offset;if("round"in o)for(var S=0;S<e.length;S++){var x=Math.pow(10,o.round);e[S]=Math.round((e[S]+Number.EPSILON)*x)/x}if(Array.isArray(i)){if("idx"!==o.op)for(var T=e.slice(),j=0;j<T.length;j++)e[j]=T[i[j]]}else if(i&&"string"==typeof i&&("asc"===i?d=sortWithIndices(e):"desc"===i&&(d=sortWithIndices(e,!1)),d))for(var w in f)for(var P=f[w].slice(),E=0;E<P.length;E++)f[w][E]=P[d[E]];if("suffix"in o)for(var O=0;O<e.length;O++)e[O]="".concat(e[O]).concat(o.suffix);for(var I in u){var C=graphExpandDotString(t,I,[]);graphTraceCbData(r,t,C,n,a,u[I],d)}}function sortWithIndices(r){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=[],n=t?1:-1,a=0;a<r.length;a++)r[a]=[r[a],a];r.sort((function(r,t){return r[0]<t[0]?-1*n:1*n}));for(var o=0;o<r.length;o++)e.push(r[o][1]),r[o]=r[o][0];return e}function graphExpandDotString(r,t,e){for(var n=t.split("."),a=r,o=0;o<n.length-1;o++)n[o]in a||(a[n[o]]={}),a=a[n[o]];return a=a[n[n.length-1]]=e}function parseGraphData(r){var t=r.text();try{return JSON.parse(t)}catch(r){return console.log("cannot parse raw data of graph"),console.log(r),null}}$(document).ready((function(){$("div.graph-base").each((function(){var r=$(this).children("div.graph-plot:first"),t=parseGraphData($(this).children("div.graph-data:first"));if(null!==t){var e=drawGraph(r,t.traces,t.layout,t.config,(function(){}),!0),n=e.traces,a=e.count;new ResizeSensor(r,(function(){a===t.traces.length&&Plotly.newPlot(r[0],n,t.layout,t.config)}))}}))}));
"use strict";$(document).ready((function(){$(".graphLegend-item").each((function(){var e=$(this).children("i.graphLegend-square").first(),r=$(this).children("div.graphLegend-color").first().text();e.css("color",r)}))}));
"use strict";function graph_sankey_compute_link_sum(e,o,r){var a=0;return e.forEach((function(e){e[o.col.key]==o.type.key&&e[r.col.key]==r.type.key&&a++})),a}function graph_sankey_compute_node_position(e,o){var r=1e-5,a=o/(e-1)+r;return a>1&&(a=.99999),a}function graph_sankey_create_col_node(e,o){return{idx:o,key:e[o].key,label:e[o].label}}function graph_sankey_create_type_node(e,o){return{idx:o,key:e.key,label:e.label,color:e.color?e.color:""}}function graph_sankey_prepare_transitions(e){for(var o=[],r=1;r<e.length;r++)o.push({source:graph_sankey_create_col_node(e,r-1),target:graph_sankey_create_col_node(e,r)});return o}function graph_sankey_postprocess_graph(e,o){e.has_node_labels||o.find("text.node-label").remove()}function graph_sankey_cb(e,o){var r=o.cols,a=o.types,t=graph_sankey_prepare_transitions(r),n={},c=0,l={source:[],target:[],value:[],color:""===o.link_color?null:[]};if(t.forEach((function(r){a.forEach((function(t,p){a.forEach((function(a,i){var _={col:r.source,type:graph_sankey_create_type_node(t,p)},s={col:r.target,type:graph_sankey_create_type_node(a,i)},y=_.col.key+"-"+_.type.key,h=s.col.key+"-"+s.type.key,u=graph_sankey_compute_link_sum(e,_,s),k="";u>=o.min&&(l.value.push(u),y in n||(_.idx=c,n[y]=_,c++),l.source.push(n[y].idx),h in n||(s.idx=c,n[h]=s,c++),l.target.push(n[h].idx),""!==(k="source"===o.link_color&&""!==_.type.color?_.type.color:"target"===o.link_color&&""!==s.type.color?s.type.color:o.link_color)&&l.color.push(k))}))}))})),l.color)for(var p=0;p<l.value.length;p++){var i=Math.trunc(255*o.link_alpha);i<0&&(i=0),i>255&&(i=255);var _=i.toString(16);1===_.length&&(_="0".concat(_)),l.color[p]&&(l.color[p]+=_)}l.hovertemplate=o.link_hovertemplate;var s={};for(var y in r.forEach((function(e,o){s[e.key]=[]})),n){var h=n[y];s[h.col.key].push(h.type.idx)}for(var u in s)s[u].sort((function(e,o){return e-o}));var k={label:[],color:[],x:[],y:[]};for(var g in n){var d=n[g];if(k.label[d.idx]=d.type.label,k.color[d.idx]=d.type.color,o.is_grouped){k.x[d.idx]=graph_sankey_compute_node_position(r.length,d.col.idx);var f=s[d.col.key].indexOf(d.type.idx);k.y[d.idx]=graph_sankey_compute_node_position(s[d.col.key].length,f)}}return k.hovertemplate=o.node_hovertemplate,{link:l,node:k}}$(document).ready((function(){$("div.graph-sankey").each((function(){var e=$(this).children("div.graph-plot"),o=parseGraphData($(this).children("div.graph-data:first")),r=parseGraphData($(this).children("div.graph-opts:first"));if(null!==o){Plotly.newPlot(e[0],[r.pre_computation],o.layout,o.config),graph_sankey_postprocess_graph(r,e),o.traces[0].data_source.cb=function(e){return graph_sankey_cb(e,r)};var a=drawGraph(e,o.traces,o.layout,o.config,(function(){graph_sankey_postprocess_graph(r,e)}),!0),t=a.traces,n=a.count;new ResizeSensor(e,(function(){n===o.traces.length&&(Plotly.newPlot(e[0],t,o.layout,o.config),graph_sankey_postprocess_graph(r,e))}))}}))}));
"use strict";function check_input_locked_after_submit(){$(".selfhelpInput").each((function(){$(this).data("locked_after_submit")&&$(this).val()&&$(this).prop("readonly",!0)}))}function init_datetime_inputs(){$("input[type='datetime']").each((function(){$(this).flatpickr({enableTime:!0,dateFormat:""==$(this).attr("data-format")?"Y-m-d H:i":$(this).attr("data-format"),time_24hr:!0,weekNumbers:!1,locale:{firstDayOfWeek:1},allowInput:!0,defaultDate:"now"==$(this).attr("value")?new Date:""})}))}function init_date_inputs(){$("input[type='date']").each((function(){$(this).flatpickr({enableTime:!1,dateFormat:""==$(this).attr("data-format")?"Y-m-d":$(this).attr("data-format"),weekNumbers:!1,locale:{firstDayOfWeek:1},allowInput:!0,defaultDate:"now"==$(this).attr("value")?new Date:""})}))}function init_time_inputs(){$("input[type='time']").each((function(){$(this).flatpickr({enableTime:!0,dateFormat:""==$(this).attr("data-format")?"H:i":$(this).attr("data-format"),time_24hr:!0,allowInput:!0,noCalendar:!0})}))}function set_focus_btn_clcik(){$(".selfhelp-icon-btn").on("click",(function(){$($(this).parent().parent().find(".selfhelp-input-date")[0]).focus()}))}$(document).ready((function(){check_input_locked_after_submit(),init_datetime_inputs(),init_date_inputs(),init_time_inputs(),set_focus_btn_clcik()}));
"use strict";function addNodeIdPrefix(i,t){t.find(".node").each((function(){$(this).attr("id").includes(i)||$(this).attr("id",i+"_"+$(this).attr("id"))}))}function growNodesToFitText(i){var t=0;i.find(".node").each((function(){var i=$(this).find("foreignObject:first"),e=i.children("div:first"),d=parseFloat(i.attr("width")),a=e.width()-d;a>t&&(t=a);var r=$(this).children().first();i.attr("width",d+a),r.attr("width",parseFloat(r.attr("width"))+a)}));var e=parseFloat(i.css("max-width")),d=i.attr("viewBox").split(" ");d[2]=parseFloat(d[2])+t,i.css("max-width",e+t),i.attr("viewBox",d.join(" "))}function addPointerClassAndClickEvent(i,t){var e=parseEditableFields(t);for(var d in e)$("#"+i+"_"+d).addClass("pointer"),$("#"+i+"_"+d).click(function(t){return function(){onClickToEdit($(this).attr("id"),i,e[t])}}(d))}function onClickToEdit(i,t,e){$("#"+t).find(":input").each((function(){t+"_"+$(this).attr("name")==i+"[value]"?(""!=e.label?$("#"+t).find(".modal-title").html(e.label):$(this).addClass("mb-3"),$(this).addClass("mermaidFieldVisible")):$(this).prop("required",!1)})),$("#"+t).modal(),$("#"+t).on("hidden.bs.modal",(function(){$(".mermaidFieldVisible").each((function(){$(this).removeClass("mermaidFieldVisible")}))}))}function parseEditableFields(i){try{return JSON.parse(i)}catch(i){return console.log(i),{}}}$(document).ready((function(){mermaid.mermaidAPI.initialize({startOnLoad:!1}),$(".mermaidForm").each((function(){var i=$(this).children("div.mermaidCode:first"),t=$(this).children("div.mermaidFormName:first").text(),e=$(this).children("div.mermaidFormEditableFields:first").text();mermaid.mermaidAPI.render("graph-"+t,i.text(),(function(d){var a=$(d);addNodeIdPrefix(t,a),i.html(a),addPointerClassAndClickEvent(t,e)}));growNodesToFitText($("#graph-"+t))}))}));
"use strict";$(document).ready((function(){$(".list-search").on("keyup",(function(){var s=$(this).val();$(this).parent().next().find("a,span").each((function(a){$(this).text().search(s)<0?$(this).parent().hide():($(this).parent().show(),$(this).parents("div.collapse").collapse("show"))}))})),$(".clear-search").on("click",(function(){$(this).prev().val(""),$(this).parent().next().find("a,span").each((function(s){$(this).parent().show()}))})),$(".nested-list a").on("click",(function(s){s.stopPropagation()})),$(".nested-list div.collapsible").on("click",(function(s){var a=$(this).next();a.hasClass("show")?a.hide("fast",(function(){a.removeClass("show")})):a.show("fast",(function(){a.addClass("show")}));var n=$(this).children(".fas:first");n.hasClass("fa-chevron-right")?n.removeClass("fa-chevron-right").addClass("fa-chevron-down"):n.hasClass("fa-chevron-down")&&n.removeClass("fa-chevron-down").addClass("fa-chevron-right")})),$(".nested-list-menu-responsive.collapsed").click((function(){var s=$(this).next();s.hasClass("show")?s.hide((function(){s.removeClass("show")})):s.show((function(){s.addClass("show")}))}))}));
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! iFrame Resizer (iframeSizer.min.js ) - v4.2.9 - 2019-12-30
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2019 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */!function(e){if("undefined"!=typeof window){var n,t=0,i=!1,o=!1,r="message".length,a="[iFrameSizer]",s=a.length,d=null,c=window.requestAnimationFrame,u={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},f={},l=null,m={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return!0},onClosed:function(){},onInit:function(){},onMessage:function(){I("onMessage function not defined")},onResized:function(){},onScroll:function(){return!0}},g={};window.jQuery&&((n=window.jQuery).fn?n.fn.iFrameResize||(n.fn.iFrameResize=function(e){return this.filter("iframe").each((function(n,t){H(t,e)})).end()}):v("","Unable to bind to jQuery, it is not fully loaded.")),"function"==typeof define&&define.amd?define([],B):"object"==("undefined"==typeof module?"undefined":_typeof(module))&&"object"==_typeof(module.exports)&&(module.exports=B()),window.iFrameResize=window.iFrameResize||B()}function h(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function p(e,n,t){e.addEventListener(n,t,!1)}function w(e,n,t){e.removeEventListener(n,t,!1)}function b(e){return f[e]?f[e].log:i}function y(e,n){x("log",e,n,b(e))}function v(e,n){x("info",e,n,b(e))}function I(e,n){x("warn",e,n,!0)}function x(e,n,t,i){!0===i&&"object"==_typeof(window.console)&&console[e](function(e){return a+"["+function(e){var n="Host page: "+e;return window.top!==window.self&&(n=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e),n}(e)+"]"}(n),t)}function F(e){function n(){t("Height"),t("Width"),W((function(){S(B),R(L),m("onResized",B)}),B,"init")}function t(e){var n=Number(f[L]["max"+e]),t=Number(f[L]["min"+e]),i=e.toLowerCase(),o=Number(B[i]);y(L,"Checking "+i+" is in range "+t+"-"+n),o<t&&(o=t,y(L,"Set "+i+" to min value")),n<o&&(o=n,y(L,"Set "+i+" to max value")),B[i]=""+o}function i(e){return A.substr(A.indexOf(":")+r+e)}function o(e,n){!function(e,n,t){g[t]||(g[t]=setTimeout((function(){g[t]=null,e()}),32))}((function(){C("Send Page Info","pageInfo:"+function(){var e=document.body.getBoundingClientRect(),n=B.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})}(),e,n)}),0,n)}function c(e){var n=e.getBoundingClientRect();return O(L),{x:Math.floor(Number(n.left)+Number(d.x)),y:Math.floor(Number(n.top)+Number(d.y))}}function u(e){var n=e?c(B.iframe):{x:0,y:0},t={x:Number(B.width)+n.x,y:Number(B.height)+n.y};y(L,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](t.x,t.y):I(L,"Unable to scroll to requested position, window.parentIFrame not found"):(d=t,l(),y(L,"--"))}function l(){!1!==m("onScroll",d)?R(L):T()}function m(e,n){return M(L,e,n)}var h,b,x,F,k,H,j,P,A=e.data,B={},L=null;"[iFrameResizerChild]Ready"===A?function(){for(var e in f)C("iFrame requested init",N(e),f[e].iframe,e)}():a===(""+A).substr(0,s)&&A.substr(s).split(":")[0]in f?(H=(k=A.substr(s).split(":"))[1]?parseInt(k[1],10):0,j=f[k[0]]&&f[k[0]].iframe,P=getComputedStyle(j),B={iframe:j,id:k[0],height:H+function(e){return"border-box"!==e.boxSizing?0:(e.paddingTop?parseInt(e.paddingTop,10):0)+(e.paddingBottom?parseInt(e.paddingBottom,10):0)}(P)+function(e){return"border-box"!==e.boxSizing?0:(e.borderTopWidth?parseInt(e.borderTopWidth,10):0)+(e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0)}(P),width:k[2],type:k[3]},L=B.id,f[L]&&(f[L].loaded=!0),(F=B.type in{true:1,false:1,undefined:1})&&y(L,"Ignoring init message from meta parent page"),!F&&(x=!0,f[b=L]||(x=!1,I(B.type+" No settings for "+b+". Message was: "+A)),x)&&(y(L,"Received: "+A),h=!0,null===B.iframe&&(I(L,"IFrame ("+B.id+") not found"),h=!1),h&&function(){var n,t=e.origin,i=f[L]&&f[L].checkOrigin;if(i&&""+t!="null"&&!(i.constructor===Array?function(){var e=0,n=!1;for(y(L,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===t){n=!0;break}return n}():(n=f[L]&&f[L].remoteHost,y(L,"Checking connection is from: "+n),t===n)))throw new Error("Unexpected message received from: "+t+" for "+B.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(f[L]&&f[L].firstRun&&f[L]&&(f[L].firstRun=!1),B.type){case"close":z(B.iframe);break;case"message":!function(e){y(L,"onMessage passed: {iframe: "+B.iframe.id+", message: "+e+"}"),m("onMessage",{iframe:B.iframe,message:JSON.parse(e)}),y(L,"--")}(i(6));break;case"autoResize":f[L].autoResize=JSON.parse(i(9));break;case"scrollTo":u(!1);break;case"scrollToOffset":u(!0);break;case"pageInfo":o(f[L]&&f[L].iframe,L),function(){function e(e,i){function r(){f[t]?o(f[t].iframe,t):n()}["scroll","resize"].forEach((function(n){y(t,e+n+" listener for sendPageInfo"),i(window,n,r)}))}function n(){e("Remove ",w)}var t=L;e("Add ",p),f[t]&&(f[t].stopPageInfo=n)}();break;case"pageInfoStop":f[L]&&f[L].stopPageInfo&&(f[L].stopPageInfo(),delete f[L].stopPageInfo);break;case"inPageLink":!function(e){var n,t=e.split("#")[1]||"",i=decodeURIComponent(t),o=document.getElementById(i)||document.getElementsByName(i)[0];o?(n=c(o),y(L,"Moving to in page link (#"+t+") at x: "+n.x+" y: "+n.y),d={x:n.x,y:n.y},l(),y(L,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(t):y(L,"In page link #"+t+" not found and window.parentIFrame not found"):y(L,"In page link #"+t+" not found")}(i(9));break;case"reset":E(B);break;case"init":n(),m("onInit",B.iframe);break;default:n()}}())):v(L,"Ignored: "+A)}function M(e,n,t){var i=null,o=null;if(f[e]){if("function"!=typeof(i=f[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=i(t)}return o}function k(e){var n=e.id;delete f[n]}function z(e){var n=e.id;if(!1!==M(n,"onClose",n)){y(n,"Removing iFrame: "+n);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){I(e)}M(n,"onClosed",n),y(n,"--"),k(e)}else y(n,"Close iframe cancelled by onClose event")}function O(n){null===d&&y(n,"Get page position: "+(d={x:window.pageXOffset!==e?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==e?window.pageYOffset:document.documentElement.scrollTop}).x+","+d.y)}function R(e){null!==d&&(window.scrollTo(d.x,d.y),y(e,"Set page position: "+d.x+","+d.y),T())}function T(){d=null}function E(e){y(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),O(e.id),W((function(){S(e),C("reset","reset",e.iframe,e.id)}),e,"reset")}function S(e){function n(n){!function(n){e.id?(e.iframe.style[n]=e[n]+"px",y(e.id,"IFrame ("+t+") "+n+" set to "+e[n]+"px")):y("undefined","messageData id not set")}(n),function(n){o||"0"!==e[n]||(o=!0,y(t,"Hidden iFrame detected, creating visibility listener"),function(){function e(){Object.keys(f).forEach((function(e){!function(e){function n(n){return"0px"===(f[e]&&f[e].iframe.style[n])}f[e]&&null!==f[e].iframe.offsetParent&&(n("height")||n("width"))&&C("Visibility change","resize",f[e].iframe,e)}(e)}))}function n(n){y("window","Mutation observed: "+n[0].target+" "+n[0].type),j(e,16)}var t=h();t&&function(){var e=document.querySelector("body");new t(n).observe(e,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0})}()}())}(n)}var t=e.iframe.id;f[t]&&(f[t].sizeHeight&&n("height"),f[t].sizeWidth&&n("width"))}function W(e,n,t){t!==n.type&&c&&!window.jasmine?(y(n.id,"Requesting animation frame"),c(e)):e()}function C(e,n,t,i,o){var r,s=!1;i=i||t.id,f[i]&&(t&&"contentWindow"in t&&null!==t.contentWindow?(r=f[i]&&f[i].targetOrigin,y(i,"["+e+"] Sending msg to iframe["+i+"] ("+n+") targetOrigin: "+r),t.contentWindow.postMessage(a+n,r)):I(i,"["+e+"] IFrame("+i+") not found"),o&&f[i]&&f[i].warningTimeout&&(f[i].msgTimeout=setTimeout((function(){!f[i]||f[i].loaded||s||(s=!0,I(i,"IFrame has not responded within "+f[i].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}),f[i].warningTimeout)))}function N(e){return e+":"+f[e].bodyMarginV1+":"+f[e].sizeWidth+":"+f[e].log+":"+f[e].interval+":"+f[e].enablePublicMethods+":"+f[e].autoResize+":"+f[e].bodyMargin+":"+f[e].heightCalculationMethod+":"+f[e].bodyBackground+":"+f[e].bodyPadding+":"+f[e].tolerance+":"+f[e].inPageLinks+":"+f[e].resizeFrom+":"+f[e].widthCalculationMethod}function H(n,o){var r,a,s,d,c,l,g=(""===(a=n.id)&&(n.id=(r=o&&o.id||m.id+t++,null!==document.getElementById(r)&&(r+=t++),a=r),i=(o||{}).log,y(a,"Added missing iframe ID: "+a+" ("+n.src+")")),a);function w(e){1/0!==f[g][e]&&0!==f[g][e]&&(n.style[e]=f[g][e]+"px",y(g,"Set "+e+" = "+f[g][e]+"px"))}function b(e){if(f[g]["min"+e]>f[g]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}g in f&&"iFrameResizer"in n?I(g,"Ignored iFrame, already setup."):(l=(l=o)||{},f[g]={firstRun:!0,iframe:n,remoteHost:n.src&&n.src.split("/").slice(0,3).join("/")},function(e){if("object"!=_typeof(e))throw new TypeError("Options is not an object")}(l),Object.keys(l).forEach((function(e){var n=e.split("Callback");if(2===n.length){var t="on"+n[0].charAt(0).toUpperCase()+n[0].slice(1);this[t]=this[e],delete this[e],I(g,"Deprecated: '"+e+"' has been renamed '"+t+"'. The old method will be removed in the next major version.")}}),l),function(e){for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&(f[g][n]=Object.prototype.hasOwnProperty.call(e,n)?e[n]:m[n])}(l),f[g]&&(f[g].targetOrigin=!0===f[g].checkOrigin?function(e){return""===e||null!==e.match(/^(about:blank|javascript:|file:\/\/)/)?"*":e}(f[g].remoteHost):"*"),function(){switch(y(g,"IFrame scrolling "+(f[g]&&f[g].scrolling?"enabled":"disabled")+" for "+g),n.style.overflow=!1===(f[g]&&f[g].scrolling)?"hidden":"auto",f[g]&&f[g].scrolling){case"omit":break;case!0:n.scrolling="yes";break;case!1:n.scrolling="no";break;default:n.scrolling=f[g]?f[g].scrolling:"no"}}(),b("Height"),b("Width"),w("maxHeight"),w("minHeight"),w("maxWidth"),w("minWidth"),"number"!=typeof(f[g]&&f[g].bodyMargin)&&"0"!==(f[g]&&f[g].bodyMargin)||(f[g].bodyMarginV1=f[g].bodyMargin,f[g].bodyMargin=f[g].bodyMargin+"px"),s=N(g),(c=h())&&(d=c,n.parentNode&&new d((function(e){e.forEach((function(e){Array.prototype.slice.call(e.removedNodes).forEach((function(e){e===n&&z(n)}))}))})).observe(n.parentNode,{childList:!0})),p(n,"load",(function(){C("iFrame.onload",s,n,e,!0),function(){var e=f[g]&&f[g].firstRun,t=f[g]&&f[g].heightCalculationMethod in u;!e&&t&&E({iframe:n,height:0,width:0,type:"init"})}()})),C("init",s,n,e,!0),f[g]&&(f[g].iframe.iFrameResizer={close:z.bind(null,f[g].iframe),removeListeners:k.bind(null,f[g].iframe),resize:C.bind(null,"Window resize","resize",f[g].iframe),moveToAnchor:function(e){C("Move to anchor","moveToAnchor:"+e,f[g].iframe,g)},sendMessage:function(e){C("Send Message","message:"+(e=JSON.stringify(e)),f[g].iframe,g)}}))}function j(e,n){null===l&&(l=setTimeout((function(){l=null,e()}),n))}function P(){"hidden"!==document.visibilityState&&(y("document","Trigger event: Visiblity change"),j((function(){A("Tab Visable","resize")}),16))}function A(e,n){Object.keys(f).forEach((function(t){!function(e){return f[e]&&"parent"===f[e].resizeFrom&&f[e].autoResize&&!f[e].firstRun}(t)||C(e,n,f[t].iframe,t)}))}function B(){function n(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),H(n,e),t.push(n))}var t;return function(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!c;e+=1)c=window[n[e]+"RequestAnimationFrame"];c?c=c.bind(window):y("setup","RequestAnimationFrame not supported")}(),p(window,"message",F),p(window,"resize",(function(){!function(e){y("window","Trigger event: "+e),j((function(){A("Window "+e,"resize")}),16)}("resize")})),p(document,"visibilitychange",P),p(document,"-webkit-visibilitychange",P),function(i,o){switch(t=[],function(e){e&&e.enablePublicMethods&&I("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}(i),_typeof(o)){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(o||"iframe"),n.bind(e,i));break;case"object":n(i,o);break;default:throw new TypeError("Unexpected data type ("+_typeof(o)+")")}return t}}}();
"use strict";$(document).ready((function(){$("iframe").on("load",(function(){iFrameResize({log:!1,heightCalculationMethod:"lowestElement"})}))}));
"use strict";function check_radio_locked_after_submit(){$(".selfhelpRadio").each((function(){console.log(),$(this).data("locked_after_submit")&&$('input[name="'+$(this).attr("name")+'"]:checked').val()&&$('input[name="'+$(this).attr("name")+'"]:not(:checked)').prop("disabled",!0)}))}$(document).ready((function(){check_radio_locked_after_submit()}));
"use strict";function initSelectImage(e){var t=$(e).attr("id"),c=$(e).attr("class"),a=new IconSelect(t),l=document.getElementById("selectValue-"+t.split("-")[1]);$(e).on("changed",(function(e){l.value=a.getSelectedValue()}));var i=$(e).attr("data-values");i=JSON.parse(i);var n=[],s=$(l).val();i.forEach((function(e){e.value==s?n.unshift({iconFilePath:e.text,iconValue:e.value}):n.push({iconFilePath:e.text,iconValue:e.value})})),a.refresh(n),$(e).addClass(c)}function check_select_locked_after_submit(){$(".selfhelpSelect").each((function(){$(this).data("locked_after_submit")&&$(this).val()&&($(this).find("option:not(:selected)").prop("disabled",!0),$(this).selectpicker("refresh"))}))}$(document).ready((function(){$(".bootstrapSelect").selectpicker({showTick:!0,allowClear:!0}),$(".selectImage").each((function(e,t){initSelectImage(t)})),check_select_locked_after_submit()}));
"use strict";$(document).ready((function(){var e=$('input[name="user_input_remove_id"]');$(".remove-user-input-field").click((function(){var t=[];$(this).siblings('[id|="user-input-field"]').each((function(){var e=$(this).attr("id").split("-");t.push(e[e.length-1])})),e.val(t)})),$(".showUserInput").each((function(){var e=$(this).attr("class").split(" "),t={columnDefs:[]};t.columnDefs.push({orderable:e.includes("dt-sortable"),targets:"_all"}),t.searching=e.includes("dt-searching"),t.bPaginate=e.includes("dt-bPaginate"),t.bInfo=e.includes("dt-bInfo");for(var n=e.filter((function(e){return e.includes("dt-order")})),r=0;r<n.length;r++){var s=n[r].split("-");4==s.length&&(s[2]!=parseInt(s[2],10)||"asc"!==s[3]&&"desc"!==s[3]||(t.order||(t.order=[]),t.order.push([s[2],s[3]])))}n=e.filter((function(e){return e.includes("dt-hide")}));for(var i=0;i<n.length;i++){var a=n[i].split("-");3==a.length&&a[2]==parseInt(a[2],10)&&t.columnDefs.push({targets:[parseInt(a[2],10)],visible:!1})}$(this).DataTable(t)}))}));
"use strict";function position_slider_legend(){$(".slider-legend").each((function(){var e=$(this).prev().outerWidth(),t=$(this).children().length,i=e/(t-1);$(this).children().each((function(s){var n=0;0==s?($(this).parent().outerHeight($(this).outerHeight()),n=0):n=s==t-1?e-$(this).outerWidth():i*s-$(this).outerWidth()/2,$(this).css({marginLeft:n})}))}))}function check_slider_locked_after_submit(){$(".selfhelpSlider").each((function(){if($(this).data("locked_after_submit")&&(""!=$(this).data("value")||0===$(this).data("value"))){$(this).css("pointer-events","none");var e=this,t=$(this).val();$(this).on("change",(function(){$(e).val(t)}))}}))}$(document).ready((function(){new ResizeSensor(jQuery(".selfhelp-slider"),(function(){position_slider_legend()})),position_slider_legend(),check_slider_locked_after_submit()}));
"use strict";$(document).ready((function(){$(".children-list.sortable").each((function(t){$(this).sortable()}))}));
"use strict";$(document).ready((function(){function t(){var t,n,a,o;t=$("button.tab-button:not(.active):not(.no-anchor-expand).style-"+window.location.hash.substring(1)),n=".tab-content-index-"+t.attr("data-context"),a=t.closest(".tabs-container").children(n),o=t.closest(".tabs-container").children("button.tab-button"),t.hasClass("active")?(t.removeClass("active"),a.slideUp("fast")):(t.addClass("active"),a.slideDown("fast")),o.not(t).removeClass("active"),t.closest(".tabs-container").children(".tab-content").not(n).hide()}$(".tabs-container").find(".tab-content").each((function(){$(this).closest(".tabs-container").append($(this))})),t(),$(window).bind("hashchange",(function(n){t()})),$("button.tab-button").click((function(){window.location.hash="#section-"+$(this).attr("data-context")}))}));
"use strict";var jsonLogicOperators={field_equal:{op:"=="},field_not_equal:{op:"!="},field_greater:{op:">"},field_less:{op:"<"},equal:{op:"=="},not_equal:{op:"!="},greater:{op:">"},less:{op:"<"},less_or_equal:{op:"<="},greater_or_equal:{op:">="},not_in:{op:"!="},in:{op:"=="},in_one_of:{op:"=="}},dataConfigInitCalls={};function calcMonacoEditorSize(e,t){var o=19*e.getModel().getLineCount();o<100&&(o=100),o>500&&(o=500),$(t).height(o),e.layout()}function setDataConfigSchema(e,t){var o=window.location.protocol+"//"+window.location.host+BASE_PATH+"/schemas/dataConfig/dataConfig.json",i=e.Uri.parse(o),a=e.editor.createModel($(t).prev().val(),"json",i);return e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:[{uri:"http://selfhelp/dataConfig.json",fileMatch:[i.toString()],schema:{$schema:o,$id:o,title:"Data config Schema",description:"Data config JSON schema",$ref:o}}]}),a}function setConditionSchema(e,t){var o=window.location.protocol+"//"+window.location.host+BASE_PATH+"/schemas/json-logic/json-logic.json",i=e.Uri.parse(o),a=e.editor.createModel($(t).prev().val(),"json",i);e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:[{uri:"http://selfhelp/json-logic.json",fileMatch:[i.toString()],schema:{$schema:"http://json-schema.org/draft-07/schema#",$id:o,title:"JSON-Logic Schema",description:"Build complex rules, serialize them as JSON, share them between front-end and back-end.",$ref:o}}]});return a}function setQualtricsSurveyConfigSchema(e,t){var o=window.location.protocol+"//"+window.location.host+BASE_PATH+"/schemas/qualtricsSurveyConfig/qualtricsSurveyConfig.json",i=e.Uri.parse(o),a=e.editor.createModel($(t).prev().val(),"json",i);e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:[{uri:"http://selfhelp/qualtricsSurveyConfig.json",fileMatch:[i.toString()],schema:{$schema:"http://json-schema.org/draft-07/schema#",$id:o,title:"Qualtrics Survey Config Schema",description:"Qualtrics Survey Config Schema",$ref:o}}]});return a}function check_textarea_locked_after_submit(){$(".selfhelpTextArea").each((function(){$(this).data("locked_after_submit")&&$(this).val()&&$(this).prop("readonly",!0)}))}function getJson(e){try{return JSON.parse($(e).prev().val())}catch(e){return console.log("Error parsing the data_config value!"),null}}function showDataConfiBuilder(e,t){var o,i=getJson(e);$(".dataConfigBuilderBtn").each((function(){$(this).click((function(){$(".data_config_builder_modal_holder").modal({backdrop:!1}),o&&o.setValue(getJson(e)),$(".data_config_builder_modal_holder").on("hidden.bs.modal",(function(e){})),$(".saveDataConfig").each((function(){$(this).attr("data-dismiss","modal"),$(this).click((function(){t.getModel().setValue(JSON.stringify(o.getValue(),null,3))}))}))}))}));var a=window.location.protocol+"//"+window.location.host+BASE_PATH+"/schemas/dataConfig/dataConfig.json";$.ajax({dataType:"json",url:a,success:function(e){for(var t in(o=new JSONEditor($(".data_config_builder")[0],{theme:"bootstrap4",iconlib:"fontawesome5",ajax:!0,schema:e,startval:i,show_errors:"always",display_required_only:!0})).on("change",(function(){for(var e in o.editors)if(o.editors.hasOwnProperty(e)&&"root"!==e&&o.watchlist&&!o.watchlist[e]&&(e.includes("table")||e.includes("type")||e.includes("field_name"))){if(e.includes("type"))getTableNames(o.getEditor(e).getValue(),o,e.replace("type","table"));else if(e.includes("field_name")){var t=e.split("."),i=t[0]+"."+t[1];getTableFieldNames(this.getEditor(i+".type").getValue(),this.getEditor(i+".table").getValue(),this,e,!0)}o.watch(e,dataConfigWatcherCallback.bind(o,e))}})),o.editors)if(o.editors.hasOwnProperty(t)&&"root"!==t)if(t.includes("type")){var a=t.replace("type","table");dataConfigInitCalls[a]=!1,getTableNames(o.getEditor(t).getValue(),o,t.replace("type","table"),o)}else if(t.includes("table")&&o.getEditor(t)&&o.getEditor(t).getValue()){a=t.replace("type","table");dataConfigInitCalls[a]=!1,getTableFieldNames(o.getEditor(t.replace("table","type")).getValue(),o.getEditor(t).getValue(),o,t.replace("table","fields"),!1,o)}}})}$(document).ready((function(){autosize($("textarea")),check_textarea_locked_after_submit(),$(".json").each((function(){require.config({paths:{vs:BASE_PATH+"/js/ext/vs"}});var e=$(this)[0];$(e).prev().attr("name").includes("jquery_builder_json")?$(e).parent().parent().addClass("d-none"):require(["vs/editor/editor.main"],(function(){var t=null;$(e).prev().attr("name").includes("data_config")?t=setDataConfigSchema(monaco,e):$(e).prev().attr("name").includes("condition")?t=setConditionSchema(monaco,e):$(e).prev().parent().attr("class")&&$(e).prev().parent().attr("class").includes("qualtricsSurveyConfig")&&(t=setQualtricsSurveyConfigSchema(monaco,e));var o={value:$(e).prev().val(),language:"json",automaticLayout:!0,renderLineHighlight:"none"};t&&(o.model=t);var i=monaco.editor.create(e,o);if(i.getAction("editor.action.formatDocument").run().then((function(){calcMonacoEditorSize(i,e)})),i.onDidChangeModelContent((function(t){$(e).prev().val(i.getValue()),calcMonacoEditorSize(i,e)})),$(e).prev().attr("name").includes("data_config"))showDataConfiBuilder(e,i);else if($(e).prev().attr("name").includes("condition")){$("textarea").each((function(){$(this).attr("name")&&$(this).attr("name").includes("jquery_builder_json")&&(a=this)})),showConditionBuilder(i,a)}else if($(e).prev().parent().attr("class")&&$(e).prev().parent().attr("class").includes("qualtricsSurveyConfig"))showQualtricsSurveyConfiBuilder(e,i);else if($(e).prev().parent().attr("class")&&$(e).prev().parent().attr("class").includes("actionConfig")){var a;showActionConfiBuilder(e,i),$("textarea").each((function(){$(this).attr("class")&&$(this).attr("class").includes("action_condition_builder")&&(a=this)})),showConditionBuilder(i,a),showActionConditionBuilder(i,a)}}))}))}));var dataConfigWatcherCallback=function(e){e.includes("type")&&this.getEditor(e)&&this.getEditor(e).getValue()?getTableNames(this.getEditor(e).getValue(),this,e.replace("type","table")):e.includes("table")&&this.getEditor(e)&&this.getEditor(e).getValue()&&getTableFieldNames(this.getEditor(e.replace("table","type")).getValue(),this.getEditor(e).getValue(),this,e.replace("table","fields"),!1)};function checkAllDataConfigInitCalls(e){var t=!0;for(var o in dataConfigInitCalls)t=dataConfigInitCalls[o]&&t;if(t)for(var i in e.editors)e.editors.hasOwnProperty(i)&&"root"!==i&&(i.includes("table")||i.includes("type")||i.includes("field_name"))&&e.watch(i,dataConfigWatcherCallback.bind(e,i))}function getTableNames(e,t,o,i){$.post(BASE_PATH+"/request/AjaxDataSource/get_table_names",{type:e},(function(e){if(e.success){var a=[];try{a=JSON.parse(e.data)}catch(t){console.log("Error while parsing",e.data)}var n=t.getEditor(o).parent;n.original_schema.properties.table.enum=a,n.schema.properties.table.enum=a,n.removeObjectProperty("table"),delete n.cached_editors.table,n.addObjectProperty("table")}else console.log(e);i&&(dataConfigInitCalls[o]=!0,checkAllDataConfigInitCalls(i))}),"json")}function getTableFieldNames(e,t,o,i,a,n){$.post(BASE_PATH+"/request/AjaxDataSource/get_table_fields",{type:e,name:t},(function(e){if(e.success){var t=[];try{t=JSON.parse(e.data)}catch(t){console.log("Error while parsing",e.data)}if(a)(l=o.getEditor(i).parent).original_schema.properties.field_name.enum=t,l.schema.properties.field_name.enum=t,l.removeObjectProperty("field_name"),delete l.cached_editors.field_name,l.addObjectProperty("field_name");else for(var r=0;r<o.getEditor(i).rows.length;r++){var l,s=o.getEditor(i+"."+r+".field_name").getValue().valueOf();(l=o.getEditor(i+"."+r+".field_name").parent).original_schema.properties.field_name.enum=t,l.schema.properties.field_name.enum=t,l.removeObjectProperty("field_name"),delete l.cached_editors.field_name,l.addObjectProperty("field_name"),o.getEditor(i+"."+r+".field_name").setValue(s)}}else console.log(e);n&&(dataConfigInitCalls[i]=!0,checkAllDataConfigInitCalls(n))}),"json")}function getGroups(e,t){$.post(BASE_PATH+"/request/AjaxDataSource/get_groups",{},(function(o){if(o.success){var i=[];try{i=JSON.parse(o.data)}catch(e){console.log("Error while parsing JSON",o.data)}prepareConditionBuilder(i,e,t)}else console.log(o)}),"json")}function prepareConditionBuilder(e,t,o){var i={icons:{add_group:"fas fa-plus-circle",add_rule:"fas fa-plus",remove_group:"fas fa-minus-square",remove_rule:"fas fa-minus-circle",error:"fas fa-exclamation-triangle",sortable:"fas fa-exclamation-triangle"},operators:$.fn.queryBuilder.constructor.DEFAULTS.operators.concat([{type:"field_equal",optgroup:"",nb_inputs:2,multiple:!1,apply_to:["string"]},{type:"field_not_equal",optgroup:"",nb_inputs:2,multiple:!1,apply_to:["string"]},{type:"field_greater",optgroup:"",nb_inputs:2,multiple:!1,apply_to:["string"]},{type:"field_less",optgroup:"",nb_inputs:2,multiple:!1,apply_to:["string"]},{type:"field_between",optgroup:"",nb_inputs:3,multiple:!1,apply_to:["string"]},{type:"between_dates",optgroup:"",nb_inputs:2,multiple:!1,apply_to:["date"]},{type:"in_one_of",optgroup:"",nb_inputs:1,multiple:!0,apply_to:["array"]}]),lang:{operators:{field_between:"[Field Name] between [value1(number)] and [value2(number)]",field_greater:"[Field Name] > [value(number)]",field_less:"[Field Name] < [value(number)]",field_equal:"[Field Name] = [value]",field_not_equal:"[Field Name] <> [value]",between_dates:"between",in_one_of:"in one of"}},filters:[{id:"user_group",label:"User group",type:"string",input:"select",multiple:!0,values:e,plugin:"selectpicker",plugin_config:{liveSearch:!0,width:"auto",liveSearchStyle:"contains"},operators:["in","not_in","in_one_of"]},{id:"field",label:"Field",type:"string",input:"text",operators:["field_equal","field_not_equal","field_greater","field_less","field_between"]},{id:"__current_date__",label:"Current Date",type:"date",validation:{format:"DD-MM-YYYY"},plugin:"flatpickr",plugin_config:{enableTime:!1,dateFormat:"d-m-Y",time_24hr:!0,weekNumbers:!0,locale:{firstDayOfWeek:1}},operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between_dates"]},{id:"__current_date_time__",label:"Current Datetime",type:"date",validation:{format:"DD-MM-YYYY HH:mm"},plugin:"flatpickr",plugin_config:{enableTime:!0,dateFormat:"d-m-Y H:i",time_24hr:!0,weekNumbers:!0,locale:{firstDayOfWeek:1}},operators:["less","less_or_equal","greater","greater_or_equal","between_dates"]},{id:"__current_time__",label:"Current Time",type:"date",validation:{format:"HH:mm"},plugin:"flatpickr",plugin_config:{enableTime:!0,dateFormat:"H:i",time_24hr:!0,noCalendar:!0},operators:["less","less_or_equal","greater","greater_or_equal","between_dates"]}]},a=null;try{if($(t).val())a=JSON.parse($(t).val());else try{var n=JSON.parse(o.getModel().getValue());n&&n.condition_jquerBuilderJson&&(a=n.condition_jquerBuilderJson)}catch(e){}}catch(e){console.log("Rules cannto be parsed")}a&&(i.rules=a),$(".condition_builder").length>0?$(".condition_builder").queryBuilder(i):$(".action_condition_builder").length>0&&$(".action_condition_builder").queryBuilder(i)}function showConditionBuilder(e,t){$(".conditionBuilderBtn").each((function(){$(this).click((function(){$(".condition_builder_modal_holder").modal({backdrop:!1}),$(".condition_builder_modal_holder").on("hidden.bs.modal",(function(e){})),$(".saveConditionBuilder").each((function(){$(this).attr("data-dismiss","modal"),$(this).click((function(){var o=$(".condition_builder").queryBuilder("getRules");$(t).val(JSON.stringify(o)),e.getModel().setValue(JSON.stringify(rulesToJsonLogic(o),null,3))}))}))}))})),getGroups(t,e)}function convertRules(e){var t={};return e&&e.condition?(t[e.condition]=[],e.rules.forEach((function(o){var i="user_group"==o.field?"$":"",a="DD-MM-YYYY HH:mm",n="YYYY-MM-DD HH:mm";if("__current_date__"==o.field?(a="DD-MM-YYYY",n="YYYY-MM-DD"):"__current_time__"==o.field&&(a="HH:mm",n="HH:mm"),["in","not_in"].includes(o.operator))o.value.forEach((function(a){var n={};n[jsonLogicOperators[o.operator].op]=[!0,i+a],t[e.condition].push(n)}));else if("in_one_of"==o.operator)t[e.condition]={or:[]},o.value.forEach((function(a){var n={};n[jsonLogicOperators[o.operator].op]=[!0,i+a],t[e.condition].or.push(n)}));else if(["field_equal","field_not_equal","field_greater","field_less"].includes(o.operator)){(r={})[jsonLogicOperators[o.operator].op]=[o.value[0],o.value[1]],t[e.condition].push(r)}else if("field_between"==o.operator)t[e.condition]={and:[]},t[e.condition].and.push({">=":[o.value[0],o.value[1]]}),t[e.condition].and.push({"<=":[o.value[0],o.value[2]]});else if("between_dates"==o.operator)t[e.condition]={and:[]},t[e.condition].and.push({">=":[o.field,new moment(o.value[0],a).format(n)]}),t[e.condition].and.push({"<=":[o.field,new moment(o.value[1],a).format(n)]});else if(["equal","not_equal","less","less_or_equal","greater","greater_or_equal"].includes(o.operator)){var r={},l=o.value;["__current_date__","__current_date_time__","__current_time__"].includes(o.field)&&(l=new moment(o.value,a).format(n)),r[jsonLogicOperators[o.operator].op]=[o.field,l],t[e.condition].push(r)}o.rules&&t[e.condition].push(convertRules(o))})),t):(alert("Wrong condition!"),{})}function rulesToJsonLogic(e){var t=convertRules(e=JSON.parse(JSON.stringify(e).replace('"AND"','"and"').replace('"OR"','"or"')));return t=JSON.parse(JSON.stringify(t).replace('"AND"','"and"').replace('"OR"','"or"'))}function showQualtricsSurveyConfiBuilder(e,t){var o,i=getJson(e);$(".qualtricsConfigBuilderBtn").each((function(){$(this).click((function(){$(".qualtricsSurveyConfig_builder_modal_holder").modal({backdrop:!1}),o&&o.setValue(getJson(e)),$(".qualtricsSurveyConfig_builder_modal_holder").on("hidden.bs.modal",(function(e){})),$(".savequaltricsSurveyConfigBuilder").each((function(){$(this).attr("data-dismiss","modal"),$(this).click((function(){t.getModel().setValue(JSON.stringify(o.getValue(),null,3))}))}))}))}));var a=window.location.protocol+"//"+window.location.host+BASE_PATH+"/schemas/qualtricsSurveyConfig/qualtricsSurveyConfig.json";$.ajax({dataType:"json",url:a,success:function(e){o=new JSONEditor($(".qualtricsSurveyConfig_builder")[0],{theme:"bootstrap4",iconlib:"fontawesome5",ajax:!0,schema:e,startval:i,show_errors:"always",display_required_only:!0})}})}function showActionConfiBuilder(e,t){var o,i=getJson(e);$(".actionConfigBuilderBtn").each((function(){$(this).click((function(){$(".actionConfig_builder_modal_holder").modal({backdrop:!1}),o&&o.setValue(getJson(e)),$(".actionConfig_builder_modal_holder").on("hidden.bs.modal",(function(e){})),$(".saveActionConfigBuilder").each((function(){$(this).attr("data-dismiss","modal"),$(this).click((function(){var e=o.getValue();!e.condition||e.condition instanceof Object||(e.condition=JSON.parse(e.condition)),!e.condition_jquerBuilderJson||e.condition_jquerBuilderJson instanceof Object||(e.condition_jquerBuilderJson=JSON.parse(e.condition_jquerBuilderJson)),t.getModel().setValue(JSON.stringify(e,null,3))}))}))}))}));var a=window.location.protocol+"//"+window.location.host+BASE_PATH+"/schemas/actionConfig/actionConfig.json";$.ajax({dataType:"json",url:a,success:function(e){(o=new JSONEditor($(".actionConfig_builder")[0],{theme:"bootstrap4",iconlib:"fontawesome5",ajax:!0,schema:e,show_errors:"always"})).on("change",(function(){$(".actionConfig_builder").find("select").each((function(){$(this).selectpicker(),$(this).selectpicker("refresh")}))})),getGroupsForActionConfig(o,i,o)}})}function getGroupsForActionConfig(e,t,o){$.post(BASE_PATH+"/request/AjaxDataSource/get_groups",{},(function(i){if(i.success){var a=[];try{a=JSON.parse(i.data)}catch(e){console.log("Error while parsing",i.data)}var n=e.getEditor("root.group").parent;n.original_schema.properties.group.items.enum=a,n.schema.properties.group.items.enum=a,n.removeObjectProperty("group"),delete n.cached_editors.group,n.addObjectProperty("group"),o.setValue(t)}else console.log(i)}),"json")}function showActionConditionBuilder(e,t){$(".actionConfigConditionBuilderBtn").each((function(){$(this).click((function(){$(".action_condition_builder_modal_holder").modal({backdrop:!1}),$(".action_condition_builder_modal_holder").on("hidden.bs.modal",(function(e){})),$(".saveActionConditionBuilder").each((function(){$(this).attr("data-dismiss","modal"),$(this).click((function(){var t=$(".action_condition_builder").queryBuilder("getRules"),o={};try{o=JSON.parse(e.getModel().getValue())}catch(e){}o.condition=rulesToJsonLogic(t),o.condition_jquerBuilderJson=t,e.getModel().setValue(JSON.stringify(o,null,3))}))}))}))})),getGroups(t,e)}
"use strict";$(document).ready((function(){$("div.condition-length"),$("div.condition-letter"),$("div.condition-number");$('input[name="pw"]').keyup((function(){var t=$(this).val();t.length>=8&&t.match(/[A-z]/)&&t.match(/\d/)?($("#pass_hint").html("match"),this.setCustomValidity("")):($("#pass_hint").html("mismatch"),this.setCustomValidity("The password must be at least 8 characters long and contain at least one letter and one number"))})),$('input[name="pw_verify"]').keyup((function(){$(this).val()===$('input[name="pw"]').val()?($("#pass_hint").html("match"),this.setCustomValidity("")):($("#pass_hint").html("mismatch"),this.setCustomValidity("The passwords must match"))}))}));